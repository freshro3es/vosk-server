# Vosk
**Vosk** — это библиотека для распознавания речи с открытым исходным кодом, которая позволяет выполнять преобразование речи в текст (speech-to-text) локально, без необходимости использования облачных сервисов. Она поддерживает несколько языков и может работать на различных платформах, включая Windows, Linux и macOS. Vosk написан на Python и предоставляет интерфейсы для других языков программирования.
## Основные особенности Vosk:

1. **Локальная работа**: Vosk выполняет все операции локально, что позволяет работать без подключения к интернету.
2. **Многоязыковая поддержка**: Поддержка множества языков и моделей.
3. **Высокая производительность**: Vosk может работать в реальном времени даже на слабых устройствах, таких как Raspberry Pi.
4. **Гибкость**: Легко интегрируется в приложения на различных платформах.

## Сервер

#### Установка Vosk и Flask:

Если вы еще не установили Vosk и Flask, вы можете сделать это с помощью pip:

```bash
pip install vosk
pip install flask
```

Далее есть два разных варианта сервера:
### Языковая модель в контейнере

#### Запуск с базовой моделью

Если мощности сервера достаточно, чтобы работать с базовым образом vosk, то можно просто запустить контейнер командой:

```bash
docker run -d -p 2700:2700 alphacep/kaldi-ru:latest
```

#### Запуск со своей моделью (опционально)

Если нужно запустить докер образ с другой моделью (например, меньше или больше по размеру, чем базовая), то можно прописать при создании контейнера путь к этой модели, как в примере:

```bash
docker run -d -p 2700:2700 -v /home/freshro3es/vosk/vosk-model-small-ru-0.22:/opt/vosk-model-ru/model alphacep/kaldi-ru:latest
```

#### Запустите сервер Flask

Запустите ваш Flask-сервер. Убедитесь, что находитесь в папке вашего проекта, где находится файл с серверным кодом ( `app-server.py`).

В командной строке (в WSL) выполните:

```bash
# Linux
export FLASK_APP=app-server.py 
export FLASK_ENV=development
flask run

# Windows
$env:FLASK_APP = "app-server.py"
$env:FLASK_ENV = "development"
python -m flask run
```

После этого Flask-сервер должен запуститься и быть доступен по адресу `http://127.0.0.1:5000`.

### Языковая модель на диске сервера

#### Скачайте модель Vosk

Перейдите на страницу загрузки моделей Vosk и выберите подходящую модель для вашего языка. Например, для английского языка можно выбрать модель `vosk-model-small-en-us-0.15`.

#### Распакуйте модель

Скачайте и распакуйте архив с моделью в удобное место на вашем компьютере. Например, вы можете распаковать его в папку `~/vosk-models/`.

#### Найдите путь к модели

Убедитесь, что вы знаете точный путь к папке с моделью. Например, если вы распаковали модель в папку `~/vosk-models/vosk-model-small-en-us-0.15`, путь к модели будет `/home/yourusername/vosk-models/vosk-model-small-en-us-0.15`.

#### Укажите путь к модели в коде

Используйте этот путь в вашем коде для создания объекта модели Vosk. Вот пример обновленного кода:

```python
# Укажите путь к вашей модели Vosk
model_path = "/home/user/vosk-model"  # замените на путь к вашей модели
model = Model(model_path)
```

#### Запустите сервер Flask

Запустите ваш Flask-сервер. Убедитесь, что находитесь в папке вашего проекта, где находится файл с серверным кодом ( `app-model.py`).

В командной строке (в WSL) выполните:

```bash
# Linux
export FLASK_APP=app-model.py 
export FLASK_ENV=development
flask run

# Windows
$env:FLASK_APP = "app-model.py"
$env:FLASK_ENV = "development"
python -m flask run
```

После этого Flask-сервер должен запуститься и быть доступен по адресу `http://127.0.0.1:5000`.

## Фронтенд

#### Откройте HTML-файл в браузере

Откройте созданный HTML-файл (`index.html`) в вашем браузере. Вы можете просто дважды щелкнуть по файлу или открыть его через контекстное меню.

> ℹ Открыть файл `index.html`, который находится в WSL, в браузере на Windows довольно просто. Один из самых простых способов - использовать встроенный в Python HTTP-сервер. Перейди в директорию с твоим `index.html` и запусти сервер командой: `python3 -m http.server 8000`

#### Загрузите аудиофайл и получите результат

1. На открывшейся веб-странице нажмите кнопку "Choose File" (или аналогичную в вашем языке), чтобы выбрать аудиофайл для загрузки.
2. Нажмите кнопку "Upload", чтобы отправить файл на сервер.

#### Проверьте результат

После отправки аудиофайла сервер должен обработать его и вернуть транскрипцию, которая будет отображена на веб-странице в разделе "Transcription Result".



